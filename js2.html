
<!DOCTYPE html>

<html>
<head>
	<!-- arrHead = ['Name of Employee', 'Mon', 'Tue', 'Wed' ,'Thu', 'Fri', 'Sat', 'Sun' ,'Salary', 'Bonus', 'Work Days', 'Paydeck'] -->
    <title>Add Dep</title>
     <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <link rel="stylesheet" type="text/css" href="js4.css">
    <style>
        table, th, td 
        {
            font: 17px Calibri;
            border: solid 1px #DDD;
            border-collapse: collapse;
            padding: 2px 3px;
            text-align: center;
            margin-top: 10px ;
            margin-left: 35px;
        }
        th {
            font-weight:bold;
        }
        .add {
            margin-left: 25%;
        }
    </style>
</head>
<body onload="savefunc()">
    <button onclick = "CreateTable()" class="btn btn-primary add">
     Add dep
    </button>
    <button onclick="DeleteTable()" class="btn btn-primary">
        Delete dep
    </button>
  <div class="div1">
      
  </div>

<script type="text/javascript">
   
	// var dep_id = localStorage.getItem("dep_id");
    function CreateTable() {
         var dep_id = localStorage.getItem('dep_id')
    var array1 = new Array()
    array1 = [ ];
    var add_button = document.createElement('button');
    var del_button = document.createElement('button');
    var cal_button = document.createElement('button');
     // SET INPUT ATTRIBUTE 'type' AND 'value'.
        add_button.setAttribute('type', 'button');
        add_button.setAttribute('class', 'btn btn-primary add');
        del_button.setAttribute('class', 'btn btn-primary');
        del_button.setAttribute('type', 'button');
        cal_button.setAttribute('type', 'button');
        cal_button.setAttribute('class', 'btn btn-primary');

        // ADD THE BUTTON's 'onclick' EVENT.
       

        add_button.innerHTML = "Add Row"
        del_button.innerHTML = "Delete Row"
        cal_button.innerHTML = "Calculate"
    	dep_id++;
        localStorage.setItem("dep_id" , dep_id);
        var table = document.createElement('table');
        table.setAttribute('id', 'datatables' + dep_id);

        var arrHead = new Array();
        arrHead = ['Name of Employee', 'Mon', 'Tue', 'Wed' ,'Thu', 'Fri', 'Sat', 'Sun' ,'Salary', 'Bonus', 'Work Days', 'Paydeck'];

        var tr = table.insertRow(-1);

        for (var h = 0; h < arrHead.length; h++) {
            var th = document.createElement('th');              // TABLE HEADER.
            th.innerHTML = arrHead[h];
            tr.appendChild(th);
        }
         
        del_button.setAttribute('id', 'delete-row'+dep_id);
        del_button.setAttribute('value', dep_id);
        add_button.setAttribute('id', 'addrow'+dep_id);
        add_button.setAttribute('value', dep_id);
        cal_button.setAttribute('value', dep_id);
        cal_button.setAttribute('id' , 'calculate'+dep_id)
        
           
      
        document.body.appendChild(table);
        document.body.appendChild(add_button);
        document.body.appendChild(del_button);
        document.body.appendChild(cal_button);

         var g = localStorage.getItem('dep_id')
    //for (var dep = 1; dep <= a; dep++) {
        $('#addrow'+g).click(function(){
           //g = this.value;
            var counter = localStorage.getItem("counter"+g);
             counter++;
            localStorage.setItem("counter"+g , counter);
            var name = "<input type='text' value='Employee"+counter+"' id = 'dep"+g+"employee"+counter+"'  onchange='function1()'>";
            var p1 ="<input type='button' class='dep"+g+"attendance"+counter+" att' value='P' onchange='function1()' id='dep"+g+"myButton1_"+counter+"'>";
            var p2 ="<input type='button' class='dep"+g+"attendance"+counter+" att' value='P' onchange='function1()' id='dep"+g+"myButton2_"+counter+"'>";
            var p3 ="<input type='button' class='dep"+g+"attendance"+counter+" att' value='P' onchange='function1()' id='dep"+g+"myButton3_"+counter+"'>";
            var p4 ="<input type='button' class='dep"+g+"attendance"+counter+" att' value='P' onchange='function1()' id='dep"+g+"myButton4_"+counter+"'>";
            var p5 ="<input type='button' class='dep"+g+"attendance"+counter+" att' value='P' onchange='function1()' id='dep"+g+"myButton5_"+counter+"'>";
            var Salary = "<input type='number' name='Salary' onchange='function1()' value='1000' id='dep"+g+"s"+counter+"'>"
            var Bonus =  "<input type='number' name='Bonus' onchange='function1()' value='200' id='dep"+g+"b"+counter+"'>"
            var WD = "<th class='wd' id='dep"+g+"wd"+counter+"'></th>"
            var Paydeck = "<th class='paydeck' id='dep"+g+"pd"+counter+"'></th>"
            var markup = "<tr id='dep"+g+"row"+counter+"' class = 'trow'><td>" + name + "</td><td>" + p1 + "</td><td>" + p2 + "</td><td>" + p3 + "</td><td>" + p4 + "</td><td>" + p5 +  "</td><td>" + "<strong>W</strong>" + "</td><td>" + "<strong>W</strong>" + "</td><td>" + Salary + "</td><td>" + Bonus  + WD + Paydeck + "</td></tr>";
    
    
            $("#datatables"+g).append(markup);
            function1();
            
            for (var n = 1; n <= counter; n++) {

   localStorage.setItem("dep" + g + "att1." + n , $("#dep" + g + "myButton1_" + n).val());
   localStorage.setItem("dep" + g + "att2." + n , $("#dep" + g + "myButton2_" + n).val());
   localStorage.setItem("dep" + g + "att3." + n , $("#dep" + g + "myButton3_" + n).val());
   localStorage.setItem("dep" + g + "att4." + n , $("#dep" + g + "myButton4_" + n).val());
   localStorage.setItem("dep" + g + "att5." + n , $("#dep" + g + "myButton5_" + n).val()); 
}

      $(".dep"+g+"attendance"+counter).click(function() {
        for (var i = 1; i <= 5; i++) {
        if ( this.value == "P") {
        this.value = 'A';
        }
    else {
         this.value = 'P'; }
     }
      for (var n = 1; n <= counter; n++) {

   localStorage.setItem("dep" + g + "att1." + n , $("#dep" + g + "myButton1_" + n).val());
   localStorage.setItem("dep" + g + "att2." + n , $("#dep" + g + "myButton2_" + n).val());
   localStorage.setItem("dep" + g + "att3." + n , $("#dep" + g + "myButton3_" + n).val());
   localStorage.setItem("dep" + g + "att4." + n , $("#dep" + g + "myButton4_" + n).val());
   localStorage.setItem("dep" + g + "att5." + n , $("#dep" + g + "myButton5_" + n).val()); 
}

 })
              })

     $("#delete-row"+g).click(function(){
       // dep_id = this.value;
      var a = localStorage.getItem("counter"+dep_id);
      var b = localStorage.getItem("counter"+dep_id);
      a -- ;
     localStorage.setItem("counter"+dep_id , a);
   document.getElementById("datatables"+dep_id).deleteRow(b);
   localStorage.removeItem("dep" + dep_id + "empl" + b);
   localStorage.removeItem("dep" + dep_id + "sal" + b);
   localStorage.removeItem("dep" + dep_id + "bon" + b);
   localStorage.removeItem("dep" + dep_id + "att1." + b);
   localStorage.removeItem("dep" + dep_id + "att2." + b);
   localStorage.removeItem("dep" + dep_id + "att3." + b);
   localStorage.removeItem("dep" + dep_id + "att4." + b);
   localStorage.removeItem("dep" + dep_id + "att5." + b);
   
   }); 
      
   
   $('#calculate'+g).click(function(){
    depid = this.value;
   var depid1 = depid+1
    for (var n = 1; n <= depid1; n++) {
     var i1=0;
 var x1 = document.getElementsByClassName("dep" + depid + "attendance" + n)[0].value;
 var x2 = document.getElementsByClassName("dep" + depid + "attendance" + n)[1].value;
 var x3 = document.getElementsByClassName("dep" + depid + "attendance" + n)[2].value;
 var x4 = document.getElementsByClassName("dep" + depid + "attendance" + n)[3].value;
 var x5 = document.getElementsByClassName("dep" + depid + "attendance" + n)[4].value;

 if ( x1 == "P")
 {
     i1++;
 }
 if ( x2 == "P")
 {
     i1++;
 }
 if ( x3 == "P")
 {
     i1++;
 }
 if ( x4 == "P")
 {
     i1++;
 }
 if ( x5 == "P")
 {
     i1++;
 }
    
document.getElementById("dep" + depid + "wd" + n).innerHTML = i1;
var s1 = document.getElementById("dep" + depid + "s" + n).value;
var b1 = document.getElementById("dep" + depid + "b" + n).value;
var d1 = i1 * s1 / 5 ;
var p1 = +d1 + +b1;
document.getElementById("dep" + depid + "pd" + n).innerHTML = p1;
localStorage.setItem("dep" + depid + "wd" +n , i1);
localStorage.setItem("dep" + depid + "pd" +n , p1);
}
   })
}

  
   $(document).ready(function(){
    var a = localStorage.getItem('dep_id')
    for (var dep = 1; dep <= a; dep++) {
        $('#addrow'+dep).click(function(){
           g = this.value;
        	var counter = localStorage.getItem("counter"+g);
        	 counter++;
        	localStorage.setItem("counter"+g , counter);
            var name = "<input type='text' value='Employee"+counter+"' id = 'dep"+g+"employee"+counter+"'  onchange='function1()'>";
            var p1 ="<input type='button' class='dep"+g+"attendance"+counter+" att' value='P' onchange='function1()' id='dep"+g+"myButton1_"+counter+"'>";
            var p2 ="<input type='button' class='dep"+g+"attendance"+counter+" att' value='P' onchange='function1()' id='dep"+g+"myButton2_"+counter+"'>";
            var p3 ="<input type='button' class='dep"+g+"attendance"+counter+" att' value='P' onchange='function1()' id='dep"+g+"myButton3_"+counter+"'>";
            var p4 ="<input type='button' class='dep"+g+"attendance"+counter+" att' value='P' onchange='function1()' id='dep"+g+"myButton4_"+counter+"'>";
            var p5 ="<input type='button' class='dep"+g+"attendance"+counter+" att' value='P' onchange='function1()' id='dep"+g+"myButton5_"+counter+"'>";
            var Salary = "<input type='number' name='Salary' onchange='function1()' value='1000' id='dep"+g+"s"+counter+"'>"
            var Bonus =  "<input type='number' name='Bonus' onchange='function1()' value='200' id='dep"+g+"b"+counter+"'>"
            var WD = "<th class='wd' id='dep"+g+"wd"+counter+"'></th>"
            var Paydeck = "<th class='paydeck' id='dep"+g+"pd"+counter+"'></th>"
            var markup = "<tr id='dep"+g+"row"+counter+"' class = 'trow'><td>" + name + "</td><td>" + p1 + "</td><td>" + p2 + "</td><td>" + p3 + "</td><td>" + p4 + "</td><td>" + p5 +  "</td><td>" + "<strong>W</strong>" + "</td><td>" + "<strong>W</strong>" + "</td><td>" + Salary + "</td><td>" + Bonus  + WD + Paydeck + "</td></tr>";
    
    
            $("#datatables"+g).append(markup);
      function1();


            for (var n = 1; n <= counter; n++) {

   localStorage.setItem("dep" + g + "att1." + n , $("#dep" + g + "myButton1_" + n).val());
   localStorage.setItem("dep" + g + "att2." + n , $("#dep" + g + "myButton2_" + n).val());
   localStorage.setItem("dep" + g + "att3." + n , $("#dep" + g + "myButton3_" + n).val());
   localStorage.setItem("dep" + g + "att4." + n , $("#dep" + g + "myButton4_" + n).val());
   localStorage.setItem("dep" + g + "att5." + n , $("#dep" + g + "myButton5_" + n).val()); 
}

      $(".dep"+g+"attendance"+counter).click(function() {
    	for (var i = 1; i <= 5; i++) {
        if ( this.value == "P") {
        this.value = 'A';
        }
  	else {
         this.value = 'P'; }
     }
      for (var n = 1; n <= counter; n++) {

   localStorage.setItem("dep" + g + "att1." + n , $("#dep" + g + "myButton1_" + n).val());
   localStorage.setItem("dep" + g + "att2." + n , $("#dep" + g + "myButton2_" + n).val());
   localStorage.setItem("dep" + g + "att3." + n , $("#dep" + g + "myButton3_" + n).val());
   localStorage.setItem("dep" + g + "att4." + n , $("#dep" + g + "myButton4_" + n).val());
   localStorage.setItem("dep" + g + "att5." + n , $("#dep" + g + "myButton5_" + n).val()); 
}

 })
  })
    
        $("#delete-row"+dep).click(function(){
        dep_id = this.value;
      var a = localStorage.getItem("counter"+dep_id);
      var b = localStorage.getItem("counter"+dep_id);
      a -- ;
     localStorage.setItem("counter"+dep_id , a);
   document.getElementById("datatables"+dep_id).deleteRow(b);
   localStorage.removeItem("dep" + dep_id + "empl" + b);
   localStorage.removeItem("dep" + dep_id + "sal" + b);
   localStorage.removeItem("dep" + dep_id + "bon" + b);
   localStorage.removeItem("dep" + dep_id + "att1." + b);
   localStorage.removeItem("dep" + dep_id + "att2." + b);
   localStorage.removeItem("dep" + dep_id + "att3." + b);
   localStorage.removeItem("dep" + dep_id + "att4." + b);
   localStorage.removeItem("dep" + dep_id + "att5." + b);
   
   }); 
      
   
   $('#calculate'+dep).click(function(){
    depid = this.value;
   var depid1 = depid+1
    for (var n = 1; n <= depid1; n++) {
     var i1=0;
 var x1 = document.getElementsByClassName("dep" + depid + "attendance" + n)[0].value;
 var x2 = document.getElementsByClassName("dep" + depid + "attendance" + n)[1].value;
 var x3 = document.getElementsByClassName("dep" + depid + "attendance" + n)[2].value;
 var x4 = document.getElementsByClassName("dep" + depid + "attendance" + n)[3].value;
 var x5 = document.getElementsByClassName("dep" + depid + "attendance" + n)[4].value;

 if ( x1 == "P")
 {
     i1++;
 }
 if ( x2 == "P")
 {
     i1++;
 }
 if ( x3 == "P")
 {
     i1++;
 }
 if ( x4 == "P")
 {
     i1++;
 }
 if ( x5 == "P")
 {
     i1++;
 }
    
document.getElementById("dep" + depid + "wd" + n).innerHTML = i1;
var s1 = document.getElementById("dep" + depid + "s" + n).value;
var b1 = document.getElementById("dep" + depid + "b" + n).value;
var d1 = i1 * s1 / 5 ;
var p1 = +d1 + +b1;
document.getElementById("dep" + depid + "pd" + n).innerHTML = p1;
localStorage.setItem("dep" + depid + "wd" +n , i1);
localStorage.setItem("dep" + depid + "pd" +n , p1);
}
   })
}
})

function savefunc() {
   var m=localStorage.getItem("dep_id");
    for (var g = 1; g <= m; g++) {
         var table = document.createElement('table');
        table.setAttribute('id', 'datatables' + g);

        var arrHead = new Array();
        arrHead = ['Name of Employee', 'Mon', 'Tue', 'Wed' ,'Thu', 'Fri', 'Sat', 'Sun' ,'Salary', 'Bonus', 'Work Days', 'Paydeck'];

        var tr = table.insertRow(-1);

        for (var h = 0; h < arrHead.length; h++) {
            var th = document.createElement('th');              // TABLE HEADER.
            th.innerHTML = arrHead[h];
            tr.appendChild(th);
        }

      
        var add_button = document.createElement('button');
        var del_button = document.createElement('button');
        var cal_button = document.createElement('button');
        add_button.setAttribute('type', 'button');
        add_button.setAttribute('class', 'btn btn-primary add');
        del_button.setAttribute('class', 'btn btn-primary');
        del_button.setAttribute('type', 'button');
        cal_button.setAttribute('type', 'button');
        cal_button.setAttribute('class', 'btn btn-primary');
         
        del_button.setAttribute('id', 'delete-row'+g);
        del_button.setAttribute('value', g);
        add_button.setAttribute('id', 'addrow'+g);
        add_button.setAttribute('value', g);
        cal_button.setAttribute('value', g);
        cal_button.setAttribute('id' , 'calculate'+g)
        
          

        add_button.innerHTML = "Add Row"
        del_button.innerHTML = "Delete Row"
        cal_button.innerHTML = "Calculate"

        document.body.appendChild(table);
        document.body.appendChild(add_button);
        document.body.appendChild(del_button);
        document.body.appendChild(cal_button);
       var c = localStorage.getItem("counter" + g)
       for (var i = 1; i <= c; i++) {
         var name = "<input type='text' value='Employee"+i+"' id = 'dep"+g+"employee"+i+"'  onchange='function1()'>";
            var p1 ="<input type='button' class='dep"+g+"attendance"+i+" att' value='P' onchange='function1()' id='dep"+g+"myButton1_"+i+"'>";
            var p2 ="<input type='button' class='dep"+g+"attendance"+i+" att' value='P' onchange='function1()' id='dep"+g+"myButton2_"+i+"'>";
            var p3 ="<input type='button' class='dep"+g+"attendance"+i+" att' value='P' onchange='function1()' id='dep"+g+"myButton3_"+i+"'>";
            var p4 ="<input type='button' class='dep"+g+"attendance"+i+" att' value='P' onchange='function1()' id='dep"+g+"myButton4_"+i+"'>";
            var p5 ="<input type='button' class='dep"+g+"attendance"+i+" att' value='P' onchange='function1()' id='dep"+g+"myButton5_"+i+"'>";
            var Salary = "<input type='number' name='Salary' onchange='function1()' value='1000' id='dep"+g+"s"+i+"'>"
            var Bonus =  "<input type='number' name='Bonus' onchange='function1()' value='200' id='dep"+g+"b"+i+"'>"
            var WD = "<th class='wd' id='dep"+g+"wd"+i+"'></th>"
            var Paydeck = "<th class='paydeck' id='dep"+g+"pd"+i+"'></th>"
            var markup = "<tr id='dep"+g+"row"+i+"' class = 'trow'><td>" + name + "</td><td>" + p1 + "</td><td>" + p2 + "</td><td>" + p3 + "</td><td>" + p4 + "</td><td>" + p5 +  "</td><td>" + "<strong>W</strong>" + "</td><td>" + "<strong>W</strong>" + "</td><td>" + Salary + "</td><td>" + Bonus  + WD + Paydeck + "</td></tr>";
    
    
            $("#datatables" + g).append(markup);


            $(".dep"+g+"attendance"+i).click(function() {
      
        for (var b = 1; b <= 5; b++) {
        if ( this.value == "P") {
        this.value = 'A';
        }
    else {
         this.value = 'P'; }
     } 
     var depid2 = localStorage.getItem("dep_id")
     for (var g = 1; g <= depid2; g++) {
    
     var c = localStorage.getItem("counter" + g)
       for (var n = 1; n <= c; n++) {

   localStorage.setItem("dep" + g + "att1." + n , $("#dep" + g + "myButton1_" + n).val());
   localStorage.setItem("dep" + g + "att2." + n , $("#dep" + g + "myButton2_" + n).val());
   localStorage.setItem("dep" + g + "att3." + n , $("#dep" + g + "myButton3_" + n).val());
   localStorage.setItem("dep" + g + "att4." + n , $("#dep" + g + "myButton4_" + n).val());
   localStorage.setItem("dep" + g + "att5." + n , $("#dep" + g + "myButton5_" + n).val()); 
 }
 }
 })

        }
        for (var n = 1; n <= c; n++) {
 document.getElementById("dep" + g + "employee" + n).value =  localStorage.getItem("dep" + g + "empl" + n);
 document.getElementById("dep" + g + "myButton1_" + n).value =  localStorage.getItem("dep" + g + "att1." + n);
 document.getElementById("dep" + g + "myButton2_" + n).value =  localStorage.getItem("dep" + g + "att2." + n);
 document.getElementById("dep" + g + "myButton3_" + n).value =  localStorage.getItem("dep" + g + "att3." + n);
 document.getElementById("dep" + g + "myButton4_" + n).value =  localStorage.getItem("dep" + g + "att4." + n);
 document.getElementById("dep" + g + "myButton5_" + n).value =  localStorage.getItem("dep" + g + "att5." + n);
 document.getElementById("dep" + g + "s" + n).value =  localStorage.getItem("dep" + g + "sal" + n);
 document.getElementById("dep" + g + "b" + n).value =  localStorage.getItem("dep" + g + "bon" + n);
 document.getElementById("dep" + g + "wd" + n).innerHTML =  localStorage.getItem("dep" + g + "wd" + n);
 document.getElementById("dep" + g + "pd" + n).innerHTML =  localStorage.getItem("dep" + g + "pd" + n);
 }
} 
 
}
function function1() {
  var n=localStorage.getItem("dep_id")
    for (var g = 1; g <= n; g++) {
       var counter = localStorage.getItem("counter" + g)
       for (var i = 1; i <= counter; i++) {
    localStorage.setItem("dep" + g + "empl" + i , $("#dep" + g + "employee" + i).val());
    localStorage.setItem("dep" + g + "sal" + i , $("#dep" + g + "s" + i).val());
    localStorage.setItem("dep" + g + "bon" + i , $("#dep" + g + "b" + i).val());
        }
 }
}
function DeleteTable(){
    var depidd = localStorage.getItem("dep_id")
    var dep_idd = localStorage.getItem("dep_id")
    var element = document.getElementById("datatables"+depidd)
    var button1 = document.getElementById("addrow"+depidd)
    var button2 = document.getElementById("delete-row"+depidd)
    var button3 = document.getElementById('calculate'+depidd)
    element.parentNode.removeChild(element);
    button1.remove();
    button2.remove();
    button3.remove();

    depidd--;
    localStorage.setItem("dep_id" , depidd)
      var c = localStorage.getItem("counter"+dep_idd);
    for (var b = 1; b <= c; b++) {
    localStorage.removeItem("counter"+dep_idd); 
    localStorage.removeItem("dep" + dep_idd + "empl" + b);
   localStorage.removeItem("dep" + dep_idd + "sal" + b);
   localStorage.removeItem("dep" + dep_idd + "bon" + b);
   localStorage.removeItem("dep" + dep_idd + "att1." + b);
   localStorage.removeItem("dep" + dep_idd + "att2." + b);
   localStorage.removeItem("dep" + dep_idd + "att3." + b);
   localStorage.removeItem("dep" + dep_idd + "att4." + b);
   localStorage.removeItem("dep" + dep_idd + "att5." + b);
   localStorage.removeItem("dep" + dep_idd + "wd" + b);
   localStorage.removeItem("dep" + dep_idd + "pd" + b); 
}
}
</script>
</body>
</html>