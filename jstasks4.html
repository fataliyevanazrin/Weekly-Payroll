<!DOCTYPE html>
<html>
<head>
	<title>Paydeck</title>
	<link rel="stylesheet" type="text/css" href="js4.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

</head>
<body onload="savefunc()">
	<div id='div1'>
		<form name="myForm" method="post" >
	   <table id ="datatables">
	   	<tr>
	   		<th style="text-align: center;"> Name of Employee</th>
	   		<th>Mon</th>
	   		<th>Tue</th>
	   		<th>Wed</th>
	   		<th>Thu</th>
	   		<th>Fri</th>
	   		<th>Sat</th>
	   		<th>Sun</th>
	   		<th style="text-align: center;">Salary</th>
	   		<th style="text-align: center;">Bonus</th>
	   		<th>Work Days</th>
	   		<th>Paydeck</th>
	   	</tr>
	   
	   </table>
     
	   <button type="button" id="btn">Add Row</button>
	   <button type="button" class="delete-row">Delete Row</button>
</form>
	   	<button onclick="Calculate()">Calculate</button>
  
	 

    </div>


    <script type="text/javascript">

    	 $(document).ready(function(){
        $("#btn").click(function(){
        	var counter = localStorage.getItem("cntr");
        	 counter++;
        	 localStorage.setItem("cntr" , counter);
            var name = "<input type='text' value='Employee "+counter+"' id = 'employee"+counter+"'  onchange='function1()'>";
            var p1 ="<input type='button' class='attendance"+counter+" att' value='P' onchange='function1()' id='myButton1_"+counter+"'>";
            var p2 ="<input type='button' class='attendance"+counter+" att' value='P' onchange='function1()' id='myButton2_"+counter+"'>";
            var p3 ="<input type='button' class='attendance"+counter+" att' value='P' onchange='function1()' id='myButton3_"+counter+"'>";
            var p4 ="<input type='button' class='attendance"+counter+" att' value='P' onchange='function1()' id='myButton4_"+counter+"'>";
            var p5 ="<input type='button' class='attendance"+counter+" att' value='P' onchange='function1()' id='myButton5_"+counter+"'>";
            var Salary = "<input type='number' name='Salary' onchange='function1()' value='1000' id='s"+counter+"'>"
            var Bonus =  "<input type='number' name='Bonus' onchange='function1()' value='200' id='b"+counter+"'>"
            var WD = "<th class='wd' id='wd"+counter+"'></th>"
            var Paydeck = "<th class='paydeck' id='pd"+counter+"'></th>"
            var markup = "<tr id='row"+counter+"'><td>" + name + "</td><td>" + p1 + "</td><td>" + p2 + "</td><td>" + p3 + "</td><td>" + p4 + "</td><td>" + p5 +  "</td><td>" + "<strong>W</strong>" + "</td><td>" + "<strong>W</strong>" + "</td><td>" + Salary + "</td><td>" + Bonus  + WD + Paydeck + "</td></tr>";
    
            $("table tbody").append(markup);
      function1();

	for (var n = 1; n <= counter; n++) {

   localStorage.setItem("att1." + n , $("#myButton1_" + n).val());
   localStorage.setItem("att2." + n , $("#myButton2_" + n).val());
   localStorage.setItem("att3." + n , $("#myButton3_" + n).val());
   localStorage.setItem("att4." + n , $("#myButton4_" + n).val());
   localStorage.setItem("att5." + n , $("#myButton5_" + n).val());
}



     $(".attendance"+counter).click(function() {

    	for (var i = 1; i <= 5; i++) {
        if ( this.value == "P") {
        this.value = 'A';
        }
  	else {
         this.value = 'P'; }
     }
      	for (var n = 1; n <= counter; n++) {

   localStorage.setItem("att1." + n , $("#myButton1_" + n).val());
   localStorage.setItem("att2." + n , $("#myButton2_" + n).val());
   localStorage.setItem("att3." + n , $("#myButton3_" + n).val());
   localStorage.setItem("att4." + n , $("#myButton4_" + n).val());
   localStorage.setItem("att5." + n , $("#myButton5_" + n).val());
}
     });	

 });

 $(".delete-row").click(function(){
      var a = localStorage.getItem("cntr");
      var b = localStorage.getItem("cntr");
      a -- ;
     localStorage.setItem("cntr" , a);
   document.getElementById("datatables").deleteRow(b);
   localStorage.removeItem("empl" + b);
   localStorage.removeItem("sal" + b);
   localStorage.removeItem("bon" + b);
   localStorage.removeItem("att1." + b);
   localStorage.removeItem("att2." + b);
   localStorage.removeItem("att3." + b);
   localStorage.removeItem("att4." + b);
   localStorage.removeItem("att5." + b);
   });    
    });

function Calculate() { 
var counter = localStorage.getItem("cntr");
for (var n = 1; n <= counter; n++) {
	
	var i1=0;
	var x1 = document.getElementsByClassName("attendance" + n)[0].value;
	var x2 = document.getElementsByClassName("attendance" + n)[1].value;
	var x3 = document.getElementsByClassName("attendance" + n)[2].value;
	var x4 = document.getElementsByClassName("attendance" + n)[3].value;
	var x5 = document.getElementsByClassName("attendance" + n)[4].value;
	
     console.log(x1);
	if ( x1 == "P")
	{
		i1++;
	}
	if ( x2 == "P")
	{
		i1++;
	}
	if ( x3 == "P")
	{
		i1++;
	}
	if ( x4 == "P")
	{
		i1++;
	}
	if ( x5 == "P")
	{
		i1++;
	}
	
document.getElementById("wd" + n).innerHTML = i1;
var s1 = document.getElementById("s" + n).value;
var b1 = document.getElementById("b" + n).value;
var d1 = i1 * s1 / 5 ;
var p1 = +d1 + +b1;
// document.getElementById("wd" + n).innerHTML = i1;
document.getElementById("pd" + n).innerHTML = p1;
//localStorage.setItem("wd" + )
}
}

  

function savefunc() {	
var counter = localStorage.getItem("cntr");

	for (var i = 1; i <= counter; i++) {
		
	  var name = "<input type='text' value='Employee "+i+"' id = 'employee"+i+"' onchange='function1()'>";
            var p1 ="<input type='button' class='attendance"+i+" att' value='P' id='myButton1_"+i+"'>";
            var p2 ="<input type='button' class='attendance"+i+" att' value='P' id='myButton2_"+i+"'>";
            var p3 ="<input type='button' class='attendance"+i+" att' value='P' id='myButton3_"+i+"'>";
            var p4 ="<input type='button' class='attendance"+i+" att' value='P' id='myButton4_"+i+"'>";
            var p5 ="<input type='button' class='attendance"+i+" att' value='P' id='myButton5_"+i+"'>";
            var Salary = "<input type='number' name='Salary' onchange='function1()' id='s"+i+"'>"
            var Bonus =  "<input type='number' name='Bonus' onchange='function1()' id='b"+i+"'>"
            var WD = "<th class='wd' id='wd"+i+"'></th>"
            var Paydeck = "<th class='paydeck' id='pd"+i+"'></th>"
            // var button = "<button onclick='Calculate()'>Calculate</button>"
            var markup = "<tr id='row"+i+"'><td>" + name + "</td><td>" + p1 + "</td><td>" + p2 + "</td><td>" + p3 + "</td><td>" + p4 + "</td><td>" + p5 +  "</td><td>" + "<strong>W</strong>" + "</td><td>" + "<strong>W</strong>" + "</td><td>" + Salary + "</td><td>" + Bonus  + WD + Paydeck  + "</td></tr>";
    
            $("table tbody").append(markup);

     $(".attendance"+i).click(function() {

    	for (var d = 1; d <= 5; d++) {
        if ( this.value == "P") {
        this.value = 'A';
        }
  	else {
         this.value = 'P'; }
     }
      	for (var n = 1; n <= counter; n++) {

   localStorage.setItem("att1." + n , $("#myButton1_" + n).val());
   localStorage.setItem("att2." + n , $("#myButton2_" + n).val());
   localStorage.setItem("att3." + n , $("#myButton3_" + n).val());
   localStorage.setItem("att4." + n , $("#myButton4_" + n).val());
   localStorage.setItem("att5." + n , $("#myButton5_" + n).val());
}
     });	

	}
for (var n = 1; n <= counter; n++) {
 document.getElementById("employee" + n).value =  localStorage.getItem("empl" + n);
 document.getElementById("myButton1_" + n).value =  localStorage.getItem("att1." + n);
 document.getElementById("myButton2_" + n).value =  localStorage.getItem("att2." + n);
 document.getElementById("myButton3_" + n).value =  localStorage.getItem("att3." + n);
 document.getElementById("myButton4_" + n).value =  localStorage.getItem("att4." + n);
 document.getElementById("myButton5_" + n).value =  localStorage.getItem("att5." + n);
 document.getElementById("s" + n).value =  localStorage.getItem("sal" + n);
 document.getElementById("b" + n).value =  localStorage.getItem("bon" + n);

 }


}
   function function1() {
  var counter = localStorage.getItem("cntr");
       for (var n = 1; n <= counter; n++) {
 	localStorage.setItem("empl" + n , $("#employee" + n).val());
 	localStorage.setItem("sal" + n , $("#s" + n).val());
 	localStorage.setItem("bon" + n , $("#b" + n).val());
 		}
 }

    </script>
</body>
</html>